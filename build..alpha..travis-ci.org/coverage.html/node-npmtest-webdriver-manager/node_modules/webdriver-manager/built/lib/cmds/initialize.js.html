<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-webdriver-manager/node_modules/webdriver-manager/built/lib/cmds/initialize.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-webdriver-manager">npmtest-webdriver-manager (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-webdriver-manager/node_modules/webdriver-manager/built/lib/cmds/initialize.js</span></h1>
    <h2>
        
        Statements: <span class="metric">18.05% <small>(24 / 133)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 46)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 14)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">18.05% <small>(24 / 133)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-webdriver-manager/node_modules/webdriver-manager/built/lib/cmds/</a> &#187; initialize.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const child_process_1 = require("child_process");
const fs = require("fs");
const glob = require("glob");
const ini = require("ini");
const path = require("path");
const q = require("q");
const config_1 = require("../config");
const utils_1 = require("../utils");
const noop = () =&gt; { };
// Make a function which configures a child process to automatically respond
// to a certain question
<span class="fstat-no" title="function not covered" >function respondFactory(question, answer, verbose) {</span>
<span class="cstat-no" title="statement not covered" >    return (child) =&gt; {</span>
<span class="cstat-no" title="statement not covered" >        child.stdin.setDefaultEncoding('utf-8');</span>
<span class="cstat-no" title="statement not covered" >        child.stdout.on('data', (data) =&gt; {</span>
<span class="cstat-no" title="statement not covered" >            if (data != null) {</span>
<span class="cstat-no" title="statement not covered" >                if (verbose) {</span>
<span class="cstat-no" title="statement not covered" >                    process.stdout.write(data);</span>
                }
<span class="cstat-no" title="statement not covered" >                if (data.toString().indexOf(question) != -1) {</span>
<span class="cstat-no" title="statement not covered" >                    child.stdin.write(answer + '\n');</span>
                }
            }
        });
    };
}
// Run a command on the android SDK
<span class="fstat-no" title="function not covered" >function runAndroidSDKCommand(sdkPath, cmd, args, stdio, config_fun) {</span>
<span class="cstat-no" title="statement not covered" >    let child = utils_1.spawn(path.resolve(sdkPath, 'tools', 'android'), [cmd].concat(args), stdio);</span>
<span class="cstat-no" title="statement not covered" >    if (config_fun) {</span>
<span class="cstat-no" title="statement not covered" >        config_fun(child);</span>
    }
    ;
<span class="cstat-no" title="statement not covered" >    let deferred = q.defer();</span>
<span class="cstat-no" title="statement not covered" >    child.on('exit', (code) =&gt; {</span>
<span class="cstat-no" title="statement not covered" >        if (deferred != null) {</span>
<span class="cstat-no" title="statement not covered" >            if (code) {</span>
<span class="cstat-no" title="statement not covered" >                deferred.reject(code);</span>
            }
            else {
<span class="cstat-no" title="statement not covered" >                deferred.resolve();</span>
            }
<span class="cstat-no" title="statement not covered" >            deferred = null;</span>
        }
    });
<span class="cstat-no" title="statement not covered" >    child.on('error', (err) =&gt; {</span>
<span class="cstat-no" title="statement not covered" >        if (deferred != null) {</span>
<span class="cstat-no" title="statement not covered" >            deferred.reject(err);</span>
<span class="cstat-no" title="statement not covered" >            deferred = null;</span>
        }
    });
<span class="cstat-no" title="statement not covered" >    return deferred.promise;</span>
}
// Download updates via the android SDK
<span class="fstat-no" title="function not covered" >function downloadAndroidUpdates(sdkPath, targets, search_all, auto_accept, verbose) {</span>
<span class="cstat-no" title="statement not covered" >    return runAndroidSDKCommand(sdkPath, 'update', ['sdk', '-u'].concat(search_all ? ['-a'] : []).concat(['-t', targets.join(',')]), auto_accept ? 'pipe' : 'inherit', auto_accept ? respondFactory('Do you accept the license', 'y', verbose) : noop);</span>
}
// Setup hardware acceleration for x86-64 emulation
<span class="fstat-no" title="function not covered" >function setupHardwareAcceleration(sdkPath) {</span>
    // TODO(sjelin): linux setup
<span class="cstat-no" title="statement not covered" >    let toolDir = path.resolve(sdkPath, 'extras', 'intel', 'Hardware_Accelerated_Execution_Manager');</span>
<span class="cstat-no" title="statement not covered" >    if (config_1.Config.osType() == 'Darwin') {</span>
<span class="cstat-no" title="statement not covered" >        console.log('Enabling hardware acceleration (requires root access)');</span>
        // We don't need the wrapped spawnSync because we know we're on OSX
<span class="cstat-no" title="statement not covered" >        child_process_1.spawnSync('sudo', ['silent_install.sh'], { stdio: 'inherit', cwd: toolDir });</span>
    }
    else <span class="cstat-no" title="statement not covered" >if (config_1.Config.osType() == 'Windows_NT') {</span>
<span class="cstat-no" title="statement not covered" >        console.log('Enabling hardware acceleration (requires admin access)');</span>
        // We don't need the wrapped spawnSync because we know we're on windows
<span class="cstat-no" title="statement not covered" >        child_process_1.spawnSync('silent_install.bat', [], { stdio: 'inherit', cwd: toolDir });</span>
    }
}
// Get a list of all the SDK download targets for a given set of APIs,
// architectures, and platforms
<span class="fstat-no" title="function not covered" >function getAndroidSDKTargets(apiLevels, architectures, platforms, oldAVDs) {</span>
<span class="fstat-no" title="function not covered" >    function getSysImgTarget(architecture, platform, level) {</span>
<span class="cstat-no" title="statement not covered" >        if (platform.toUpperCase() == 'DEFAULT') {</span>
<span class="cstat-no" title="statement not covered" >            platform = 'android';</span>
        }
<span class="cstat-no" title="statement not covered" >        return 'sys-img-' + architecture + '-' + platform + '-' + level;</span>
    }
<span class="cstat-no" title="statement not covered" >    let targets = apiLevels</span>
        .map((level) =&gt; {
<span class="cstat-no" title="statement not covered" >        return 'android-' + level;</span>
    })
        .concat(architectures.reduce((targets, architecture) =&gt; {
<span class="cstat-no" title="statement not covered" >        return targets.concat.apply(targets, platforms.map((platform) =&gt; {</span>
<span class="cstat-no" title="statement not covered" >            return apiLevels.map(getSysImgTarget.bind(null, architecture, platform));</span>
        }));
    }, []));
<span class="cstat-no" title="statement not covered" >    oldAVDs.forEach((name) =&gt; {</span>
<span class="cstat-no" title="statement not covered" >        let avd = new AVDDescriptor(name);</span>
<span class="cstat-no" title="statement not covered" >        if (targets.indexOf(avd.api) == -1) {</span>
<span class="cstat-no" title="statement not covered" >            targets.push(avd.api);</span>
        }
<span class="cstat-no" title="statement not covered" >        let sysImgTarget = getSysImgTarget(avd.architecture, avd.platform, avd.api.slice('android-'.length));</span>
<span class="cstat-no" title="statement not covered" >        if (targets.indexOf(sysImgTarget) == -1) {</span>
<span class="cstat-no" title="statement not covered" >            targets.push(sysImgTarget);</span>
        }
    });
<span class="cstat-no" title="statement not covered" >    return targets;</span>
}
// All the information about an android virtual device
class AVDDescriptor {
    constructor<span class="fstat-no" title="function not covered" >(api, platform, architecture) {</span>
<span class="cstat-no" title="statement not covered" >        if (platform != undefined) {</span>
<span class="cstat-no" title="statement not covered" >            this.api = api;</span>
<span class="cstat-no" title="statement not covered" >            this.platform = platform;</span>
<span class="cstat-no" title="statement not covered" >            this.architecture = architecture;</span>
<span class="cstat-no" title="statement not covered" >            this.name = [api, platform, architecture].join('-');</span>
        }
        else {
<span class="cstat-no" title="statement not covered" >            this.name = api;</span>
<span class="cstat-no" title="statement not covered" >            let nameParts = this.name.split('-');</span>
<span class="cstat-no" title="statement not covered" >            this.api = nameParts[0] + '-' + nameParts[1];</span>
<span class="cstat-no" title="statement not covered" >            if (/v[0-9]+[a-z]+/.test(nameParts[nameParts.length - 1]) &amp;&amp;</span>
                (nameParts[nameParts.length - 2].slice(0, 3) == 'arm')) {
<span class="cstat-no" title="statement not covered" >                this.architecture = nameParts[nameParts.length - 2] + '-' + nameParts[nameParts.length - 1];</span>
            }
            else {
<span class="cstat-no" title="statement not covered" >                this.architecture = nameParts[nameParts.length - 1];</span>
            }
<span class="cstat-no" title="statement not covered" >            this.platform = this.name.slice(this.api.length + 1, -this.architecture.length - 1);</span>
        }
<span class="cstat-no" title="statement not covered" >        this.abi =</span>
            (this.platform.toUpperCase() == 'DEFAULT' ? '' : this.platform + '/') + this.architecture;
    }
    avdName<span class="fstat-no" title="function not covered" >(version) {</span>
<span class="cstat-no" title="statement not covered" >        return this.name + '-v' + version + '-wd-manager';</span>
    }
}
// Gets the descriptors for all AVDs which are possible to make given the
// SDKs which were downloaded
<span class="fstat-no" title="function not covered" >function getAVDDescriptors(sdkPath) {</span>
<span class="cstat-no" title="statement not covered" >    let deferred = q.defer();</span>
    // `glob` package always prefers patterns to use `/`
<span class="cstat-no" title="statement not covered" >    glob('system-images/*/*/*', { cwd: sdkPath }, (err, files) =&gt; {</span>
<span class="cstat-no" title="statement not covered" >        if (err) {</span>
<span class="cstat-no" title="statement not covered" >            deferred.reject(err);</span>
        }
        else {
<span class="cstat-no" title="statement not covered" >            deferred.resolve(files.map((file) =&gt; {</span>
                // `file` could use `/` or `\`, so we use `path.normalize`
<span class="cstat-no" title="statement not covered" >                let info = path.normalize(file).split(path.sep).slice(-3);</span>
<span class="cstat-no" title="statement not covered" >                return new AVDDescriptor(info[0], info[1], info[2]);</span>
            }));
        }
    });
<span class="cstat-no" title="statement not covered" >    return deferred.promise;</span>
}
<span class="fstat-no" title="function not covered" >function sequentialForEach(array, func) {</span>
<span class="cstat-no" title="statement not covered" >    let ret = q(null);</span>
<span class="cstat-no" title="statement not covered" >    array.forEach((x) =&gt; {</span>
<span class="cstat-no" title="statement not covered" >        ret = ret.then(() =&gt; {</span>
<span class="cstat-no" title="statement not covered" >            return func(x);</span>
        });
    });
<span class="cstat-no" title="statement not covered" >    return ret;</span>
}
// Configures the hardware.ini file for a system image of a new AVD
<span class="fstat-no" title="function not covered" >function configureAVDHardware(sdkPath, desc) {</span>
<span class="cstat-no" title="statement not covered" >    let file = path.resolve(sdkPath, 'system-images', desc.api, desc.platform, desc.architecture, 'hardware.ini');</span>
<span class="cstat-no" title="statement not covered" >    return q.nfcall(fs.stat, file)</span>
        .then((stats) =&gt; {
<span class="cstat-no" title="statement not covered" >        return q.nfcall(fs.readFile, file);</span>
    }, (err) =&gt; {
<span class="cstat-no" title="statement not covered" >        return q('');</span>
    })
        .then((contents) =&gt; {
<span class="cstat-no" title="statement not covered" >        let config = ini.parse(contents.toString());</span>
<span class="cstat-no" title="statement not covered" >        config['hw.keyboard'] = 'yes';</span>
<span class="cstat-no" title="statement not covered" >        config['hw.battery'] = 'yes';</span>
<span class="cstat-no" title="statement not covered" >        config['hw.ramSize'] = 1024;</span>
<span class="cstat-no" title="statement not covered" >        return q.nfcall(fs.writeFile, file, ini.stringify(config));</span>
    });
}
// Make an android virtual device
<span class="fstat-no" title="function not covered" >function makeAVD(sdkPath, desc, version, verbose) {</span>
<span class="cstat-no" title="statement not covered" >    return runAndroidSDKCommand(sdkPath, 'delete', ['avd', '--name', desc.avdName(version)])</span>
        .then(noop, noop)
        .then(() =&gt; {
<span class="cstat-no" title="statement not covered" >        return runAndroidSDKCommand(sdkPath, 'create', ['avd', '--name', desc.avdName(version), '--target', desc.api, '--abi', desc.abi], 'pipe', respondFactory('Do you wish to create a custom hardware profile', 'no', verbose));</span>
    });
}
// Initialize the android SDK
<span class="fstat-no" title="function not covered" >function android(sdkPath, apiLevels, architectures, platforms, acceptLicenses, version, oldAVDs, logger, verbose) {</span>
<span class="cstat-no" title="statement not covered" >    let avdDescriptors;</span>
<span class="cstat-no" title="statement not covered" >    let tools = ['platform-tool', 'tool'];</span>
<span class="cstat-no" title="statement not covered" >    if ((config_1.Config.osType() == 'Darwin') || (config_1.Config.osType() == 'Windows_NT')) {</span>
<span class="cstat-no" title="statement not covered" >        tools.push('extra-intel-Hardware_Accelerated_Execution_Manager');</span>
    }
<span class="cstat-no" title="statement not covered" >    logger.info('android-sdk: Downloading additional SDK updates');</span>
<span class="cstat-no" title="statement not covered" >    downloadAndroidUpdates(sdkPath, tools, false, acceptLicenses, verbose)</span>
        .then(() =&gt; {
<span class="cstat-no" title="statement not covered" >        return setupHardwareAcceleration(sdkPath);</span>
    })
        .then(() =&gt; {
<span class="cstat-no" title="statement not covered" >        logger.info('android-sdk: Downloading more additional SDK updates ' +</span>
            '(this may take a while)');
<span class="cstat-no" title="statement not covered" >        return downloadAndroidUpdates(sdkPath, ['build-tools-24.0.0'].concat(getAndroidSDKTargets(apiLevels, architectures, platforms, oldAVDs)), true, acceptLicenses, verbose);</span>
    })
        .then(() =&gt; {
<span class="cstat-no" title="statement not covered" >        return getAVDDescriptors(sdkPath);</span>
    })
        .then((descriptors) =&gt; {
<span class="cstat-no" title="statement not covered" >        avdDescriptors = descriptors;</span>
<span class="cstat-no" title="statement not covered" >        logger.info('android-sdk: Configuring virtual device hardware');</span>
<span class="cstat-no" title="statement not covered" >        return sequentialForEach(avdDescriptors, (descriptor) =&gt; {</span>
<span class="cstat-no" title="statement not covered" >            return configureAVDHardware(sdkPath, descriptor);</span>
        });
    })
        .then(() =&gt; {
<span class="cstat-no" title="statement not covered" >        return sequentialForEach(avdDescriptors, (descriptor) =&gt; {</span>
<span class="cstat-no" title="statement not covered" >            logger.info('android-sdk: Setting up virtual device "' + descriptor.name + '"');</span>
<span class="cstat-no" title="statement not covered" >            return makeAVD(sdkPath, descriptor, version, verbose);</span>
        });
    })
        .then(() =&gt; {
<span class="cstat-no" title="statement not covered" >        return q.nfcall(fs.writeFile, path.resolve(sdkPath, 'available_avds.json'), JSON.stringify(avdDescriptors.map((descriptor) =&gt; {</span>
<span class="cstat-no" title="statement not covered" >            return descriptor.name;</span>
        })));
    })
        .then(() =&gt; {
<span class="cstat-no" title="statement not covered" >        logger.info('android-sdk: Initialization complete');</span>
    })
        .done();
}
exports.android = android;
;
<span class="fstat-no" title="function not covered" >function iOS(logger) {</span>
<span class="cstat-no" title="statement not covered" >    if (config_1.Config.osType() != 'Darwin') {</span>
<span class="cstat-no" title="statement not covered" >        throw new Error('Must be on a Mac to simulate iOS devices.');</span>
    }
<span class="cstat-no" title="statement not covered" >    try {</span>
<span class="cstat-no" title="statement not covered" >        fs.statSync('/Applications/Xcode.app');</span>
    }
    catch (e) {
<span class="cstat-no" title="statement not covered" >        logger.warn('You must install the xcode commandline tools!');</span>
    }
}
exports.iOS = iOS;
//# sourceMappingURL=initialize.js.map
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Thu Apr 20 2017 17:32:54 GMT+0000 (UTC)</div>
</div>
</body>
</html>
